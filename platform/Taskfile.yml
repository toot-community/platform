version: "3"

env:
  ENV: production

tasks:
  plan:
    cmds:
      - terraform init -backend-config="./configs/$ENV/state.config" -reconfigure
      - terraform plan -var-file="./configs/$ENV/vars.tfvars"

  apply:
    cmds:
      - terraform init -backend-config="./configs/$ENV/state.config" -reconfigure
      - terraform apply -var-file="./configs/$ENV/vars.tfvars"

  destroy:
    cmds:
      - terraform init -backend-config="./configs/$ENV/state.config" -reconfigure
      - terraform destroy -var-file="./configs/$ENV/vars.tfvars"
